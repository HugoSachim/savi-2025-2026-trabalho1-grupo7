# SAVI_Trabalho_prático_1
Trabalho prático 1 

O objetivo do trabalho prático 1 foi a familiarização dos estudantes com objetos do tipo point cloud, desde a sua "construção", tratamento com algoritmo ICP (iterative closest point) e desenvolviemnto do prórpio algoritmo costumizado. 

Tarefa 1:

A tarefa 1 consiste na criação de 2 point clouds através de imagens rgbd (rgb + depth) e posterior alinhamento através do algoritmo ICP. Para isso usaram-se as funções da livraria open3d. Primeiramente leram-se 2 pares de imagens constituídos por 1 imagem rgb e outra imagem de profundidade (depth). Através da função "o3d.geometry.RGBDImage.create_from_tum_format" foi possível criar as imagens rgbd e de seguida utilizando "o3d.geometry.PointCloud.create_from_rgbd_image", as imagens anteriores e parâmetros de câmara default criaram-se as point clouds.
Antes do alinhamento, foi feita uma fase de pré-processamento das nuvens de pontos, onde se aplicou downsampling e cálculo das normais locais, além da extração das características FPFH (Fast Point Feature Histograms), utilizadas no método de Fast Global Registration para identificar correspondências entre as duas nuvens. Também se gravaram estas point clouds como ficheiros .ply para um posterior pré-alinhamento no software CloudCompare. Para diminuir o esforço computacional assim como o tempo de execução do algoritmo foi realizado uma diminuição da densidade dos pontos com um parâmetro de 0,025. Foi criada uma função para fazer o display das 2 nuvens de pontos transformadas por uma matriz de transformação. Estas funções foram usadas ao longo do código para visualizar o processo de alinhamento. Alternativamente, foi também testado o método de Fast Global Registration (FGR) fornecido pela Open3D. Este método calcula uma transformação inicial automática com base nas características FPFH das duas nuvens de pontos, permitindo obter um alinhamento inicial aproximado sem necessidade de software externo. Em seguida aplicou-se a função ICP point to point. Esta função toma como argumentos 2 point clouds, a fonte, que vai ser alterada, e a alvo, que serve como referência. Recebe também uma distância máxima a que os pontos devem estar para ser aplicado o método, uma matriz de transformação inicial (obtida por CloudCompare ou então por FastGlobalRegistrationOption, sendo que esta última apenas alinha as nuvens grosseiramente) e o número máximo de iterações caso não se atinja convergência. O algoritmo ICP ponto a ponto procura para cada ponto na nuvem de pontos fonte, o ponto a menor distância euclidiana da nuvem de pontos alvo. Se a distância fôr maior que o limite definido a correspondência não é considerada. De seguida o algoritmo calcula o centróide dos pontos correspondidos na nuvem alvo, e faz a translação do centróide da nuvem fonte para coincidir com o anterior. O segundo passo é minimizar a distância medida anteriormente, por meio da rotação da nuvem alvo, de modo que a média da distância euclidiana entre os pontos seja mínima. Estes passos são repetidos até se obter convergência satisfatória. Posteriormente, aplicou-se também o método ICP point to plane. Este método é uma variação do anterior, mas em vez de minimizar a distância direta entre pontos correspondentes, minimiza a distância de cada ponto da nuvem fonte ao plano definido pela normal do ponto (calculado anteriormente) correspondente na nuvem alvo. Este método tende a convergir mais rapidamente e com maior precisão quando as nuvens já estão razoavelmente alinhadas. Por fim, foi desenvolvida uma pequena interface gráfica em PyQt5 que permite visualizar interativamente cada etapa do alinhamento (inicial, pré-alinhamento, FGR, ICP point-to-point e ICP point-to-plane), bem como alternar entre diferentes esquemas de cores para distinguir facilmente as duas nuvens de pontos.

Para execução é necessário as seguintes bibliotecas:
open3d matplotlib numpy pyvista pyvistaqt PyQt5

![alt text](images/Screenshot from 2025-11-13 20-24-22.png)
![Nuvens iniciais](images/Screenshot from 2025-11-13 20-24-40.png)
